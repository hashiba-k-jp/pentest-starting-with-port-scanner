#!/usr/bin/python3
# coding: UTF-8

# This code is based on https://github.com/oreilly-japan/pentest-starting-with-port-scanner
# https://github.com/oreilly-japan/pentest-starting-with-port-scanner/blob/main/code/chapter02/tcp-connect-scan-by-socket.py
# Kotake Taichi @Sterra Security Co.,Ltd., "pentest starting with port scanner", O'reilly Japan, ISBN 978-4-8144-0042-3

import socket
import sys

if len(sys.argv) != 3:
    print(f"[usage] : {{sudo}} python3 {sys.argv[0]} {{dst IP addr}} {{dst port}}\nsudo should be added when needed.")
    sys.exit()

target_ip = sys.argv[1]
target_port = int(sys.argv[2])

s = socket.socket()
errno = s.connect_ex((target_ip, target_port))
s.close()

if errno == 0:
    print(f"[running] TCP port {target_port} is open.")
else:
    print(f"[running] TCP port {target_port} is closed...")
